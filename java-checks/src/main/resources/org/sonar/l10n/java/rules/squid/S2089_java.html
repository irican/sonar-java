<p>HTTP请求中的字段是攻击者手中的putty，您不能指望它们告诉您任何事情的真相。虽然在这些值被中和之后存储这些值可能是安全的，
但是不应该根据它们的内容做出决定。</p>
<p>此规则标记referer头字段的使用。</p>
<h2>不合规的代码示例</h2>
<pre>
public class MyServlet extends HttpServlet {
  protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    String referer = request.getHeader("referer");  // 不合规
    if(isTrustedReferer(referer)){
      //..
    }
    //...
  }
}
</pre>
<h2>请参阅</h2>
<ul>
  <li> <a href="http://cwe.mitre.org/data/definitions/807">MITRE, CWE-807</a> - Reliance on Untrusted Inputs in a Security Decision </li>
  <li> <a href="http://cwe.mitre.org/data/definitions/293">MITRE, CWE-293</a> - Using Referer Field for Authentication </li>
  <li> OWASP Top 10 2017 Category A2 - Broken Authentication </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>

